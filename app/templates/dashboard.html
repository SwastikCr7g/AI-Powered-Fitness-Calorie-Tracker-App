<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fitness Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Montserrat&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(to right, #00c6ff, #0072ff);
            color: white;
            text-align: center;
            padding: 40px;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 36px;
            margin-bottom: 20px;
        }

        .info-box {
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 20px auto;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        input[type="number"], select {
            padding: 10px;
            border-radius: 8px;
            border: none;
            width: 60%;
            margin-right: 10px;
            margin-top: 10px;
        }

        button, .link-button {
            padding: 10px 20px;
            border: none;
            background: #00ff9c;
            color: black;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin-top: 10px;
        }

        .circle-chart {
            margin: 30px auto;
            width: 200px;
            height: 200px;
            background: conic-gradient(#00ff9c calc(var(--percentage) * 1%), #fff 0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            position: relative;
        }

        .circle-chart::before {
            content: "";
            position: absolute;
            width: 140px;
            height: 140px;
            background: #111;
            border-radius: 50%;
        }

        .circle-chart span {
            position: absolute;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }

        ul li {
            margin: 5px 0;
        }

        .top-links {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }

        .top-links-left {
            position: absolute;
            top: 20px;
            left: 20px;
        }
    </style>
</head>
<body>

    <!-- Top Left: Export Report -->
    <div class="top-links-left">
        <a href="/export-report" class="link-button">üìä Export Report</a>
    </div>

    <!-- Top Right: Logout -->
    <div class="top-links">
        <form action="/logout" method="post">
            <button class="link-button" style="background:#ff4d4d;">üë§ Logout</button>
        </form>
    </div>

    <h1>Welcome, {{ name }}!</h1>

    <div class="info-box">
        <p><strong>Daily Required Calories:</strong> {{ required }}</p>
        <p><strong>Calories Consumed:</strong> <span id="intake">{{ intake }}</span></p>
        <p><strong>Calories Burned:</strong> <span id="burned">{{ burned }}</span></p>
        <p><strong>Remaining Calories:</strong> <span id="remaining">{{ required - intake }}</span></p>

        <div class="circle-chart" style="--percentage: {{ (intake / required) * 100 if required else 0 | round(0) }}">
            <span id="progress">{{ (intake / required) * 100 if required else 0 | round(0) }}%</span>
        </div>
    </div>

    <div class="info-box">
        <h3>Add Food</h3>
        <select id="food">
            <option disabled selected>Select food item</option>
            {% for food in [
                "Roti", "Paneer", "Dal", "Rice", "Chicken Curry", "Samosa", "Dosa", "Idli", "Chole", "Bhature",
                "Paratha", "Upma", "Poha", "Vada", "Aloo Sabzi", "Rajma", "Pulao", "Biryani", "Cutlet", "Pakora",
                "Kofta", "Palak Paneer", "Chana Masala", "Mutter Paneer", "Aloo Paratha", "Curd", "Butter Naan",
                "Bread", "Egg", "Fish Curry", "Milk", "Banana", "Apple", "Orange", "Grapes", "Mango", "Pineapple",
                "Papaya", "Lassi", "Halwa", "Gulab Jamun", "Rasgulla", "Kheer", "Jalebi", "Ice Cream", "Tea", "Coffee",
                "Vegetable Soup", "Corn", "Sprouts", "Green Salad", "Sandwich", "Maggi", "Pav Bhaji", "Vada Pav",
                "Misal Pav", "Bhel Puri", "Sev Puri", "Dhokla", "Khichdi", "Thepla", "Undhiyu", "Sheera",
                "Sabudana Khichdi", "Thalipeeth", "Modak", "Shrikhand", "Aamras", "Zunka", "Bhakri", "Kanda Poha",
                "Besan Chilla", "Methi Thepla", "Batata Wada", "Kachori", "Sabji", "Tofu", "Tofu Curry", "Oats",
                "Oats Upma", "Veg Frankie", "Chana Chaat", "Sprouts Salad", "Veg Wrap", "Paneer Roll",
                "Moong Dal Chilla", "Lemon Water", "Buttermilk", "Soy Milk", "Egg Curry", "Rava Upma", "Paneer Bhurji"
            ] %}
            <option value="{{ food }}">{{ food }}</option>
            {% endfor %}
        </select>
        <button onclick="addFood()">Add</button>
    </div>

    <div class="info-box">
        <h3>üçï Food History</h3>
        <ul id="food-history">
            {% for food in food_history %}
            <li>{{ food.item }} - {{ food.calories }} kcal</li>
            {% endfor %}
        </ul>
    </div>

    <div class="info-box">
        <h3>Add Burned Calories</h3>
        <input type="number" id="burn" placeholder="Calories burned">
        <button onclick="addBurn()">Add</button>
    </div>

    <script>
        function addFood() {
            const food = document.getElementById("food").value;
            fetch('/add-food', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ food: food })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("intake").innerText = data.total_intake;
                document.getElementById("remaining").innerText = data.remaining;
                let percentage = (data.total_intake / {{ required }}) * 100;
                document.querySelector('.circle-chart').style.setProperty('--percentage', percentage);
                document.getElementById("progress").innerText = Math.min(Math.round(percentage), 100) + "%";

                const foodHistory = document.getElementById('food-history');
                const newItem = document.createElement('li');
                newItem.textContent = `${food} - ${data.calories} kcal`;
                foodHistory.appendChild(newItem);
            });
        }

        function addBurn() {
            const burn = document.getElementById("burn").value;
            fetch('/add-burn', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ burn: burn })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("burned").innerText = data.total_burned;
            });
        }
    </script>

</body>
</html>
